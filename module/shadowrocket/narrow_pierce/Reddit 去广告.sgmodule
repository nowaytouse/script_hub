#!name=Reddit å»å¹¿å‘Š
#!desc=[ğŸš€SR] è¿‡æ»¤æ¨å¹¿, å…³ NSFW æç¤º, è‡ªåŠ¨å¼€å¯ç¿»è¯‘(JQ ç‰ˆ)
#!category=ã€ ğŸ¯ Narrow Pierce â€º çª„åŸŸç©¿åˆº ã€
#!arguments=NSFW:"Nsfw",TRANSLATION:"http-request"
#!arguments-desc=\n1ï¸âƒ£ NSFW\n\nå¡«å†™ Nsfw æ—¶, è¡¨ç¤ºå…³é—­ NSFW æç¤º, å…¶ä»–å€¼è¡¨ç¤ºæ¢å¤é»˜è®¤è¡Œä¸º\n\n2ï¸âƒ£ TRANSLATION\n\nå¡«å†™ http-request æ—¶, è¡¨ç¤ºå¼€å¯è‡ªåŠ¨ç¿»è¯‘, # è¡¨ç¤ºå…³é—­è‡ªåŠ¨ç¿»è¯‘.\nâš ï¸ ç”±äºæ— æ³•åŒºåˆ†é¦–æ¬¡åŸå§‹è¯·æ±‚å’Œæ‰‹åŠ¨ç‚¹å‡»ç¿»è¯‘çš„è¯·æ±‚, å¼€å¯ä¹‹å App å†…åˆ‡æ¢åŠŸèƒ½å°±æ— æ•ˆäº†...

[General]

force-http-engine-hosts =  gql.reddit.com, gql-fed.reddit.com

[MITM]

hostname = , gql.reddit.com, gql-fed.reddit.com

[Body Rewrite]

# walk(
#   if type == "object" then
#     (if .isPROXY == true then .isPROXY = false else . end)
#     | (if .isPROXYMediaBlocked == true then .isPROXYMediaBlocked = false else . end)
#     | (if .isPROXYContentShown == false then .isPROXYContentShown = true else . end)
#     | (if (.commentsPageAds | type == "array") then (.commentsPageAds = []) else . end)
#     | (if ( (.node | type == "object") and (.node.cells | type == "array") and (.node.cells | any(.__typename? == "AdMetadataCell" or .isAdPost? == true)) ) then empty else . end)
#     | (if (.node | type == "object") and (.node.adPayload | type == "object") then empty else . end)
#     | (if .__typename == "AdPost" then empty else . end)
#   else . 
# end)

http-response-jq ^https?:\/\/gql(-fed)?\.reddit\.com 'walk( if type == "object" then (if .isPROXY == true then .isPROXY = false else . end) | (if .isPROXYMediaBlocked == true then .isPROXYMediaBlocked = false else . end) | (if .isPROXYContentShown == false then .isPROXYContentShown = true else . end) | (if (.commentsPageAds | type == "array") then (.commentsPageAds = []) else . end) | (if ( (.node | type == "object") and (.node.cells | type == "array") and (.node.cells | any(.__typename? == "AdMetadataCell" or .isAdPost? == true)) ) then empty else . end) | (if (.node | type == "object") and (.node.adPayload | type == "object") then empty else . end) | (if .__typename == "AdPost" then empty else . end) else . end)'

[Header Rewrite]
PROXY ^https:\/\/gql-fed\.reddit\.com\/ header-del x-reddit-translations
PROXY ^https:\/\/gql-fed\.reddit\.com\/ header-add x-reddit-translations "enabled"